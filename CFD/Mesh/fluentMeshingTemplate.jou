/file/set-tui-version "22.1"

;load base case as template
(cx-gui-do cx-activate-item "MenuBar*ReadSubMenu*Case...")
(cx-gui-do cx-set-file-dialog-entries "Select File" '( "baseCase.msh.cas.h5") "CFF Case Files (*.cas.h5 *.msh.h5 )")
(%py-exec "meshing.GlobalSettings.LengthUnit.setState(None)")
(%py-exec "workflow.LoadState(ListOfRoots=[r'meshing', r'workflow'])")

;import geometry file
(%py-exec "workflow.TaskObject['Import Geometry'].Execute()")

;edit local sizing parameters of surfaces
(%py-exec "workflow.TaskObject['wingsurf'].Arguments.setState({r'AddChild': r'yes',r'BOIControlName': r'wingsurf',r'BOIFaceLabelList': [r'wingsurf'],r'BOISize': SIZEWINGSURF,})")
(%py-exec "workflow.TaskObject['wingtip'].Arguments.setState({r'AddChild': r'yes',r'BOIControlName': r'wingtip',r'BOIFaceLabelList': [r'wingtip'],r'BOISize': SIZEWINGTIP,})")

;edit boundary layers
(%py-exec "workflow.TaskObject['uniform_1'].Arguments.setState({r'AddChild': r'yes',r'BLControlName': r'uniform_1',r'BLRegionList': [r'volumenk-rper'],r'BLZoneList': [r'wingtip', r'wingsurf', r'volumenk-rper:1'],r'CompleteBLRegionList': [r'volumenk-rper'],r'CompleteBLZoneList': [r'wingtip', r'wingsurf', r'volumenk-rper:1'],r'FirstHeight': 0.3,r'NumberOfLayers': NUMBEROFLAYERS,r'OffsetMethodType': r'uniform',})")


;generate mesh
(%py-exec "workflow.TaskObject['Generate the Volume Mesh'].ExecuteUpstreamNonExecutedAndThisTask()")

;write mesh to case file
(cx-gui-do cx-activate-item "MenuBar*WriteSubMenu*Case...")
(cx-gui-do cx-set-file-dialog-entries "Select File" '( "//192.168.178.31/moritz/Studium/Projektarbeit/Projektarbeit_CFD/autoCFDTool/CFD/Mesh/CFD_Mesh.cas.h5") "CFF Case Files (*.cas.h5 )")

;exit fluent meshing
exit